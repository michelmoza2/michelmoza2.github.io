<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://bootswatch.com/5/minty/bootstrap.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>ProductosBd</title>
</head>
<body>
<center>
    <h1>productosBd</h1>
</center>
<div class="container">
    <table class="table table-striped table-hover" id="tabla-productosBd">
        <thead>
            <tr class="fila-productosBd">
                <th>Id</th>
                <th>Descripcion</th>
                <th>Nombre</th>
                <th>Precio</th>
                <th>Estado</th>
                <th>Imagen</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <br>
    <form class="form-inline" id="formulario-productosBd">
        <div class="form-group row">
            <div class="col-sm-2">
                <input type="number" id="id" name="id" placeholder="Id"  class="form-control rounded-0">
            </div>
            <div class="col-sm-2">
                <input type="text" id="descripcion" name="descripcion" placeholder="Descripcion" class="form-control rounded-0">
            </div>
            <div class="col-sm-2">
                <input type="text" id="nombre" name="nombre" placeholder="Nombre" class="form-control rounded-0">
            </div>
            <div class="col-sm-2">
                <input type="number" id="precio" name="precio" placeholder="Precio" class="form-control rounded-0">
            </div>
            <div class="col-sm-2">
                <select id="estado" name="estado" class="form-control">
                    <option value="Femenino">Activo</option>
                    <option value="Masculino">Inactivo</option>
                </select>
            </div>
            <div class="col-sm-2">
                <input type="text" id="imagen" name="imagen" class="form-control rounded-0">
            </div>
        </div>
    </form>             
    <br>
    <button type="submit" class="btn btn-primary " id="buscar">Buscar</button>
    <button type="button" class="btn btn-success" id="agregar" >Agregar</button>
    <button type="button" class="btn btn-danger" id="borrar">Borrar</button>
    <button type="button" class="btn btn-warning" id="modificar" >Modificar</button>
</div>
<script>
$(document).ready(function() {

// Función para cargar la tabla de alumnos
function cargarTablaproductosBd() {
$.get('/mostrarTodos', function(productosBd) {
var tbody = $('#tabla-productosBd tbody');
tbody.empty();
for (var i = 0; i < productosBd.length; i++) {
  var productosBd = productosBd[i];
  var tr = $('<tr>').addClass('fila-productosBd').appendTo(tbody);
    $('<td>').text(productosBd.id).appendTo(tr);
    $('<td>').text(productosBd.descripcion).appendTo(tr);
    $('<td>').text(productosBd.nombre).appendTo(tr);
    $('<td>').text(productosBd.precio).appendTo(tr);
    $('<td>').text(productosBd.estado).appendTo(tr);
    $('<td>').text(productosBd.imagen).appendTo(tr);
}
});
}

// Carga la tabla de alumnos al cargar la página
cargarTablaproductosBd();

// Función para buscar un alumno
$('#buscar').click(function() {
var id = $('#id').val();
$.get(`/buscarId/${id}`, function(productosBd) {
$('#id').val(productosBd.id);
$('#nombre').val(productosBd.descripcion);
$('#nombre').val(productosBd.nombre);
$('#precio').val(productosBd.precio);
$('#estado').val(productosBd.estado);
$('#imagen').val(productosBd.imagen);
}).fail(function(error) {
alert(error.responseJSON.message);
});
});

// Función para agregar un alumno
$('#agregar').click(function() {
var productosBd = {
id: $('#id').val(),
descripcion: $('#descripcion').val(),
nombre: $('#nombre').val(),
precio: $('#precio').val(),
estado: $('#estado').val(),
imagen: $('#imagen').val(),
};
$.post('/insertar', productosBd, function() {
cargarTablaproductosBd();
alert('producto agregado correctamente');
}).fail(function(error) {
alert('Error');
});
});

// Función para borrar un alumno
$('#borrar').click(function() {
var id = $('#id').val();
$.ajax({
url: `/borrar/${id}`,
type: 'DELETE',
success: function() {
    cargarTablaproductosBd();
  alert('Producto borrado correctamente');
},
error: function(error) {
  alert(error.responseJSON.message);
}
});
});

// Función para modificar un alumno
$('#modificar').click(function() {
var id = $('#id').val();
var productosBd = {
id: $('#id').val(),
descripcion: $('#descripcion').val(),
nombre: $('#nombre').val(),
precio: $('#precio').val(),
estado: $('#estado').val(),
imagen: $('#imagen').val(),
};
$.ajax({
url: `/actualizar/${id}`,
type: 'PUT',
data: productosBd,
success: function() {
  cargarTablaproductosBd();
  alert('Producto actualizado correctamente');
},
error: function(error) {
  alert('Error al actualizar');
}
});
});
});
</script>
</body>
</html>